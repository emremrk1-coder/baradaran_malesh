<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ù¾Ú©ÛŒØ¬ VIP Ø¨Ø±Ø§Ø¯Ø±Ø§Ù† Ù…Ù„Ø´ - Ø¨Ù‡ØªØ±ÛŒÙ† Ù…Ø´Ø§ÙˆØ±Ø§Ù† Ú©Ù†Ú©ÙˆØ± Ø¨Ø±Ø§ÛŒ Ø±Ø³ÛŒØ¯Ù† Ø¨Ù‡ Ù†Ù…Ø±Ù‡ Ø¨Ø§Ù„Ø§ÛŒ Û±Û¸ Ùˆ Ø±ØªØ¨Ù‡ Ø¨Ø±ØªØ±. Ø¹Ø¶ÙˆÛŒØª Ø±Ø§ÛŒÚ¯Ø§Ù† Ùˆ Ú©Ø§Ø±Øª VIP Ù„ÙˆÚ©Ø³!">
    <title>Ù¾Ú©ÛŒØ¬ Ø¨Ø±Ø§Ø¯Ø±Ø§Ù† Ù…Ù„Ø´ | VIP</title>

    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6610f2;
            --accent-color: #28a745;
            --text-color: #333;
            --bg-light: #f0f4f8;
            --bg-dark: #d9e2ec;
            --shadow-color: rgba(0, 123, 255, 0.3);
            --border-radius: 30px;
            --transition-speed: 0.3s;
            --font-family: 'Vazirmatn', sans-serif;
            --font-weight-light: 300;
            --font-weight-normal: 400;
            --font-weight-bold: 700;
            --font-weight-black: 900;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            background: linear-gradient(135deg, var(--bg-light), var(--bg-dark));
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            transition: padding var(--transition-speed);
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            font-size: 4rem;
            font-weight: var(--font-weight-black);
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            animation: fadeInDown 1s ease-out;
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .logo {
            width: 200px;
            margin: 20px auto;
            display: block;
            border-radius: 50%;
            box-shadow: 0 0 20px var(--shadow-color);
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
        }

        .logo:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px var(--shadow-color);
        }

        .description {
            max-width: 900px;
            margin: 40px auto;
            background: rgba(255, 255, 255, 0.8);
            padding: 40px;
            border-radius: var(--border-radius);
            line-height: 2;
            font-size: 1.2rem;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
            animation: fadeIn 1.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .description h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 2.5rem;
            font-weight: var(--font-weight-bold);
        }

        .highlight {
            color: var(--accent-color);
            font-weight: var(--font-weight-black);
            font-size: 1.5rem;
            background: linear-gradient(transparent 60%, rgba(40, 167, 69, 0.2) 60%);
            padding: 0 5px;
        }

        .tutors {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 30px;
            margin: 30px 0;
        }

        .tutor {
            text-align: center;
            transition: transform var(--transition-speed);
        }

        .tutor:hover {
            transform: translateY(-10px);
        }

        .tutor img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary-color);
            box-shadow: 0 0 15px var(--shadow-color);
            transition: border-color var(--transition-speed);
        }

        .tutor img:hover {
            border-color: var(--secondary-color);
        }

        .tutor p {
            margin: 10px 0 0;
            font-weight: var(--font-weight-bold);
            color: var(--text-color);
        }

        .sample-card {
            max-width: 400px;
            margin: 40px auto;
            overflow: hidden;
            border-radius: 20px;
            box-shadow: 0 0 30px var(--shadow-color);
            transition: box-shadow var(--transition-speed);
        }

        .sample-card:hover {
            box-shadow: 0 0 40px var(--shadow-color);
        }

        .sample-card img {
            width: 100%;
            display: block;
        }

        form {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.8);
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        }

        input {
            width: 100%;
            padding: 18px;
            border-radius: 20px;
            border: 1px solid var(--primary-color);
            font-size: 1.2rem;
            margin-top: 20px;
            background: #fff;
            transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
        }

        input:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 10px var(--shadow-color);
            outline: none;
        }

        button {
            width: 100%;
            padding: 18px;
            border-radius: 20px;
            border: none;
            font-size: 1.2rem;
            margin-top: 20px;
            background: var(--accent-color);
            color: #fff;
            font-weight: var(--font-weight-bold);
            cursor: pointer;
            transition: background var(--transition-speed), transform var(--transition-speed);
        }

        button:hover {
            background: darken(var(--accent-color), 10%);
            transform: scale(1.02);
        }

        #modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-content {
            background: #fff;
            padding: 50px;
            border-radius: var(--border-radius);
            text-align: center;
            width: 90%;
            max-width: 500px;
            color: var(--text-color);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            animation: zoomIn 0.5s ease-out;
        }

        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .card {
            width: 380px;
            height: 240px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color), #6f42c1);
            border-radius: 20px;
            padding: 30px;
            color: #fff;
            font-weight: var(--font-weight-bold);
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.8);
            position: relative;
            overflow: hidden;
            margin: 30px auto;
        }

        .card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0.1), rgba(0, 0, 0, 0.2));
            pointer-events: none;
            border-radius: 20px;
        }

        .card h3 {
            margin: 0;
            font-size: 2rem;
            text-shadow: 2px 2px 6px #000;
        }

        .card p {
            margin: 12px 0;
            font-size: 1.4rem;
            text-shadow: 1px 1px 4px #000;
        }

        .card .member-id {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.1rem;
            background: rgba(0, 0, 0, 0.6);
            padding: 8px 15px;
            border-radius: 12px;
        }

        #adminPanel {
            display: none;
            max-width: 900px;
            margin: 100px auto;
            background: rgba(255, 255, 255, 0.8);
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid var(--primary-color);
            padding: 10px;
            text-align: center;
            transition: background var(--transition-speed);
        }

        th {
            background: var(--primary-color);
            color: #fff;
            font-weight: var(--font-weight-bold);
        }

        tr:hover td {
            background: rgba(var(--primary-color), 0.1);
        }

        .contacts {
            max-width: 600px;
            margin: 60px auto 40px;
            background: rgba(255, 255, 255, 0.8);
            padding: 40px;
            border-radius: var(--border-radius);
            text-align: center;
            font-size: 1.2rem;
            opacity: 0;
            transform: translateY(50px) scale(0.95);
            transition: all 1s ease-out;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        }

        .contacts.visible {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .contacts .telegram-icon {
            font-size: 3rem;
            animation: pulse 2s infinite;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .contacts a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: var(--font-weight-bold);
            font-size: 1.6rem;
            display: block;
            margin-top: 15px;
            transition: transform var(--transition-speed), color var(--transition-speed);
        }

        .contacts a:hover {
            transform: scale(1.1);
            color: var(--secondary-color);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }

        .admin-entry {
            text-align: center;
            margin-top: 50px;
        }

        .admin-button {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 0.9rem;
            cursor: pointer;
            text-decoration: underline;
            transition: color var(--transition-speed);
        }

        .admin-button:hover {
            color: var(--secondary-color);
        }

        /* Media Queries for Responsiveness */

        @media (max-width: 1200px) {
            .container {
                max-width: 1000px;
            }
        }

        @media (max-width: 992px) {
            .container {
                max-width: 800px;
                padding: 30px 15px;
            }

            h1 {
                font-size: 3.5rem;
            }

            .description {
                padding: 30px;
                font-size: 1.1rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px 10px;
            }

            h1 {
                font-size: 2.8rem;
            }

            .logo {
                width: 150px;
            }

            .description {
                padding: 25px;
                font-size: 1.1rem;
            }

            .tutors {
                gap: 20px;
            }

            .tutor img {
                width: 100px;
                height: 100px;
            }

            form {
                padding: 25px;
            }

            input, button {
                padding: 15px;
                font-size: 1.1rem;
            }

            .card {
                width: 320px;
                height: 200px;
                padding: 20px;
            }

            .card h3 {
                font-size: 1.8rem;
            }

            .card p {
                font-size: 1.2rem;
            }

            .modal-content {
                padding: 30px;
            }

            .contacts {
                padding: 30px;
                margin: 40px auto;
            }

            .contacts .telegram-icon {
                font-size: 2.5rem;
            }

            .contacts a {
                font-size: 1.4rem;
            }
        }

        @media (max-width: 576px) {
            h1 {
                font-size: 2.5rem;
            }

            .description {
                padding: 20px;
                font-size: 1rem;
            }

            .tutors {
                flex-direction: column;
                gap: 15px;
            }

            .card {
                width: 280px;
                height: 180px;
                padding: 15px;
            }

            .card h3 {
                font-size: 1.6rem;
            }

            .card p {
                font-size: 1.1rem;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 2.3rem;
            }

            .description {
                padding: 20px;
                font-size: 1rem;
            }

            .card {
                width: 280px;
                height: 180px;
            }
        }

        @media (max-width: 360px) {
            .container {
                padding: 15px 5px;
            }

            input, button {
                font-size: 1rem;
            }
        }

        /* Additional Enhancements */

        .fade-in-section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }

        .fade-in-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Dark Mode Support */

        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #1a1a1a, #2c3e50);
                color: #f0f4f8;
            }

            .description, form, #adminPanel, .contacts {
                background: rgba(0, 0, 0, 0.8);
            }

            .modal-content {
                background: #2c3e50;
                color: #f0f4f8;
            }

            th {
                background: var(--secondary-color);
            }

            input {
                background: #333;
                color: #fff;
                border-color: var(--secondary-color);
            }

            .highlight {
                background: linear-gradient(transparent 60%, rgba(40, 167, 69, 0.4) 60%);
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>Ù¾Ú©ÛŒØ¬ Ø¨Ø±Ø§Ø¯Ø±Ø§Ù† Ù…Ù„Ø´</h1>

        <img src="https://img.freepik.com/free-vector/luxury-eagle-with-gold-color-logo-template_361591-404.jpg" alt="Ù„ÙˆÚ¯Ùˆ Ù„ÙˆÚ©Ø³ Ø¨Ø±Ø§Ø¯Ø±Ø§Ù† Ù…Ù„Ø´" class="logo">

        <div class="description fade-in-section">
            <h2>Ø¨Ù‡ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡ Ø¨Ø²Ø±Ú¯ Ø¨Ø±Ø§Ø¯Ø±Ø§Ù† Ù…Ù„Ø´ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ ğŸ’</h2>
            <p>Ù¾Ú©ÛŒØ¬ VIP Ø¨Ø±Ø§Ø¯Ø±Ø§Ù† Ù…Ù„Ø´ Ø¨Ø§ Ø­Ø¶ÙˆØ± Ø¨Ù‡ØªØ±ÛŒÙ† Ù…Ø´Ø§ÙˆØ±Ø§Ù† Ùˆ Ø±ØªØ¨Ù‡â€ŒØ¨Ø±ØªØ±Ù‡Ø§ÛŒ Ú©Ù†Ú©ÙˆØ± Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ ØªØ§ Ø´Ù…Ø§ Ø±Ùˆ Ø¨Ù‡ <span class="highlight">Ù†Ù…Ø±Ù‡ Ø¨Ø§Ù„Ø§ÛŒ Û±Û¸ Ùˆ Ø±ØªØ¨Ù‡ Ø¨Ø±ØªØ±</span> Ø¨Ø±Ø³ÙˆÙ†Ù‡!</p>

            <div class="tutors">
                <div class="tutor">
                    <img src="https://media.istockphoto.com/id/1209164876/photo/portrait-of-young-persian-man-doctor-with-finger-on-lips.jpg?s=612x612&w=0&k=20&c=b07HsspVzQA7irQod5a08nDRfvLxms7YHG9x3OKRmzY=" alt="Ø¯Ú©ØªØ± Ø§Ø±Ù…ÛŒÙ† Ø¹Ù„ÛŒØ²Ø§Ø¯Ù‡">
                    <p>Ø¯Ú©ØªØ± Ø§Ø±Ù…ÛŒÙ† Ø¹Ù„ÛŒØ²Ø§Ø¯Ù‡ âš•ï¸</p>
                </div>
                <div class="tutor">
                    <img src="https://tuck.dartmouth.edu/images/made/uploads/articles/emilio-rosillo_1660_1060_75_s_c1.jpg" alt="Ø¢ÛŒØ¯ÛŒÙ† Ù‡ÛŒÙˆÙ‡â€ŒÚ†ÛŒ">
                    <p>Ø¢ÛŒØ¯ÛŒÙ† Ù‡ÛŒÙˆÙ‡â€ŒÚ†ÛŒ ğŸ§ </p>
                </div>
                <div class="tutor">
                    <img src="https://miro.medium.com/v2/resize:fill:1200:632/g:fp:0.5:0.33/1*cbfKy0kHoRTCGtjDkdgkvg.jpeg" alt="Ø§Ù…ÛŒØ± Ø¹Ù„ÛŒ Ù„Ø·ÙÛŒ">
                    <p>Ø§Ù…ÛŒØ± Ø¹Ù„ÛŒ Ù„Ø·ÙÛŒ ğŸ”¥</p>
                </div>
            </div>

            <p class="highlight">Ù…Ú˜Ø¯Ù‡! Ø¹Ø¶ÙˆÛŒØª ØªØ§ Ø§Ø·Ù„Ø§Ø¹ Ø«Ø§Ù†ÙˆÛŒ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø±Ø§ÛŒÚ¯Ø§Ù† Ø§Ø³Øª ğŸ‰</p>
            <p>Ø¨Ø§ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø²ÛŒØ±ØŒ Ú©Ø§Ø±Øª Ø¹Ø¶ÙˆÛŒØª Ù„ÙˆÚ©Ø³ VIP Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯ Ùˆ Ø¨Ù‡ Ø¬Ù…Ø¹ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ù…ÙˆÙÙ‚ Ù…Ù„Ø´ Ø¨Ù¾ÛŒÙˆÙ†Ø¯ÛŒØ¯.</p>

            <div class="sample-card">
                <img src="https://thumbs.dreamstime.com/z/elevate-your-status-golden-vip-membership-card-exclusive-access-luxury-rewards-await-unleash-world-premium-privileges-377439113.jpg" alt="Ù†Ù…ÙˆÙ†Ù‡ Ú©Ø§Ø±Øª Ø¹Ø¶ÙˆÛŒØª Ù„ÙˆÚ©Ø³ VIP">
            </div>
        </div>

        <form id="form" class="fade-in-section">
            <input id="name" placeholder="Ù†Ø§Ù…" required>
            <input id="family" placeholder="Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ" required>
            <button type="submit">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ùˆ Ø³Ø§Ø®Øª Ú©Ø§Ø±Øª</button>
        </form>
    </div>

    <div class="contacts" id="contacts">
        <div class="telegram-icon">âœˆï¸</div>
        <p>Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù…Ø´Ø§ÙˆØ±Ù‡ ÙÙˆØ±ÛŒØŒ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ Ùˆ Ù…Ø­ØªÙˆØ§ÛŒ VIP</p>
        <p>Ø¨Ù‡ Ú©Ø§Ù†Ø§Ù„ ØªÙ„Ú¯Ø±Ø§Ù… Ø¨Ø±Ø§Ø¯Ø±Ø§Ù† Ù…Ù„Ø´ Ø¨Ù¾ÛŒÙˆÙ†Ø¯ÛŒØ¯:</p>
        <a href="https://t.me/baradaran_malesh" target="_blank">t.me/baradaran_malesh</a>
    </div>

    <div id="modal">
        <div class="modal-content">
            <h2>ğŸ‰ Ú©Ø§Ø±Øª Ø¹Ø¶ÙˆÛŒØª Ø´Ù…Ø§ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø¯!</h2>

            <div class="card" id="card">
                <h3>VIP MEMBER</h3>
                <div class="member-id" id="memberId"></div>
                <p id="cardName"></p>
                <p id="joinDate"></p>
                <p>Ø¨Ø±Ø§Ø¯Ø±Ø§Ù† Ù…Ù„Ø´</p>
            </div>

            <button onclick="downloadCard()">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ø§Ø±Øª (PNG)</button>
            <br><br>
            <button onclick="closeModal()">Ø¨Ø³ØªÙ†</button>
        </div>
    </div>

    <div id="adminPanel">
        <h2>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¹Ø¶Ø§</h2>
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>Ù†Ø§Ù…</th>
                    <th>Ø²Ù…Ø§Ù† Ø«Ø¨Øª</th>
                </tr>
            </thead>
            <tbody id="members"></tbody>
        </table>
    </div>

    <div class="container admin-entry">
        <button class="admin-button" onclick="showAdminPrompt()">âš™ï¸ ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±ÛŒØª</button>
    </div>

    <script>
        // ==== ØªÙ†Ø¸ÛŒÙ…Ø§Øª Supabase ====
        const supabase = Supabase.createClient(
            'https://istsjonmxovepanbfxpa.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlzdHNqb25teG92ZXBhbmJmeHBhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5ODU2NTAsImV4cCI6MjA4MTU2MTY1MH0.X96ZtEj5EnCLL2aVOKBOheT5x9mLxLzMS9LmUo5t5dw'
        );

        const form = document.getElementById("form");
        const modal = document.getElementById("modal");
        const cardName = document.getElementById("cardName");
        const joinDate = document.getElementById("joinDate");
        const memberId = document.getElementById("memberId");
        const adminPanel = document.getElementById("adminPanel");
        const membersTbody = document.getElementById("members");
        const contactsSection = document.getElementById("contacts");

        let members = [];

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add("visible");
                }
            });
        }, { threshold: 0.3 });

        observer.observe(contactsSection);

        const fadeObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add("visible");
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.fade-in-section').forEach(section => {
            fadeObserver.observe(section);
        });

        async function loadMembers() {
            const { data, error } = await supabase
                .from('members')
                .select('*')
                .order('created_at', { ascending: true });

            if (error) {
                console.error("Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø¹Ø¶Ø§:", error);
                return;
            }

            members = data || [];
            renderMembers();
        }

        function renderMembers() {
            membersTbody.innerHTML = "";
            members.forEach((m, i) => {
                const row = document.createElement("tr");
                row.innerHTML = `<td>\( {i + 1}</td><td> \){m.name}</td><td>${m.time}</td>`;
                membersTbody.appendChild(row);
            });
        }

        form.addEventListener("submit", async e => {
            e.preventDefault();
            const nameInput = document.getElementById("name").value.trim();
            const familyInput = document.getElementById("family").value.trim();
            if (!nameInput || !familyInput) {
                alert("Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.");
                return;
            }
            const fullName = nameInput + " " + familyInput;
            const timeNow = new Date().toLocaleString("fa-IR");

            const { count: currentCount, error: countError } = await supabase
                .from('members')
                .select('id', { count: 'exact', head: true });

            if (countError) {
                console.error("Ø®Ø·Ø§ Ø¯Ø± Ø´Ù…Ø§Ø±Ø´ Ø§Ø¹Ø¶Ø§:", countError);
                alert("Ø®Ø·Ø§ÛŒÛŒ Ø±Ø® Ø¯Ø§Ø¯ØŒ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯.");
                return;
            }

            const { data, error } = await supabase
                .from('members')
                .insert({ name: fullName, time: timeNow })
                .select();

            if (error || !data || data.length === 0) {
                console.error("Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡:", error);
                alert("Ø®Ø·Ø§ÛŒÛŒ Ø±Ø® Ø¯Ø§Ø¯ØŒ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯.");
                return;
            }

            const insertedId = data[0].id || (currentCount + 1); // fallback if no id

            cardName.textContent = fullName;
            joinDate.textContent = "ØªØ§Ø±ÛŒØ® Ø¹Ø¶ÙˆÛŒØª: " + timeNow;
            memberId.textContent = "Ú©Ø¯ Ø¹Ø¶ÙˆÛŒØª: " + ("000" + insertedId).slice(-4);

            modal.style.display = "flex";
            confetti({ particleCount: 300, spread: 100, colors: ['#007bff', '#6610f2', '#6f42c1', '#28a745'] });

            await loadMembers();

            form.reset();
        });

        function showAdminPrompt() {
            const pass = prompt("Ø±Ù…Ø² Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:");
            if (pass === "BaradaranMalesh1404VIP") {
                adminPanel.style.display = "block";
                loadMembers();
            } else if (pass !== null) {
                alert("Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª!");
            }
        }

        function downloadCard() {
            html2canvas(document.getElementById("card"), {scale: 3}).then(canvas => {
                const a = document.createElement("a");
                const idText = memberId.textContent.split(": ")[1] || "0000";
                a.download = "BaradaranMalesh_VIP_Card_" + idText + ".png";
                a.href = canvas.toDataURL("image/png");
                a.click();
            });
        }

        function closeModal() {
            modal.style.display = "none";
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ù„ÛŒØ³Øª Ø§Ø¹Ø¶Ø§
        loadMembers();

        // Additional JS for better UX
        window.addEventListener('scroll', () => {
            if (!contactsSection.classList.contains('visible')) {
                const rect = contactsSection.getBoundingClientRect();
                if (rect.top < window.innerHeight) {
                    contactsSection.classList.add('visible');
                }
            }
        });
    </script>

</body>
  </html>
